<?xml version="1.0" ?>
<mujoco model="athena_tvc">
    <compiler angle="radian" coordinate="local" inertiafromgeom="true"/>
    
    <option gravity="0 0 -9.81" timestep="0.001" integrator="RK4">
        <flag warmstart="enable" energy="enable"/>
    </option>
    
    <!-- Assets for visualization -->
    <asset>
        <!-- Textures -->
        <texture name="grid" type="2d" builtin="checker" width="300" height="300" rgb1="0.1 0.2 0.3" rgb2="0.2 0.3 0.4"/>
        <texture name="rocket_tex" type="cube" builtin="flat" mark="cross" width="100" height="100" rgb1="0.8 0.8 0.9" rgb2="0.7 0.7 0.8"/>
        <texture name="gimbal_tex" type="cube" builtin="flat" mark="random" width="100" height="100" rgb1="0.9 0.5 0.1" rgb2="0.8 0.4 0.0"/>
        <texture name="actuator_tex" type="cube" builtin="flat" width="50" height="50" rgb1="0.3 0.3 0.8" rgb2="0.2 0.2 0.7"/>
        
        <!-- Materials -->
        <material name="grid" texture="grid" texrepeat="8 8" reflectance="0.2"/>
        <material name="rocket" texture="rocket_tex" rgba="0.8 0.8 0.9 1"/>
        <material name="gimbal" texture="gimbal_tex" rgba="0.9 0.5 0.1 1"/>
        <material name="actuator" texture="actuator_tex" rgba="0.3 0.3 0.8 1"/>
        <material name="thrust_nozzle" rgba="0.5 0.5 0.5 1"/>
        <material name="transparent" rgba="1 1 1 0.3"/>
    </asset>
    
    <!-- Default values for physical properties -->
    <default>
        <joint limited="true" damping="0.05" stiffness="0" frictionloss="0.01"/>
        <geom material="rocket" condim="3" friction="1 0.005 0.0001"/>
        <motor ctrllimited="true" forcelimited="true"/>
        <position ctrllimited="true" kp="10" forcelimited="true"/>
    </default>
    
    <worldbody>
        <!-- Ground plane -->
        <geom name="floor" pos="0 0 -2" size="10 10 0.1" type="plane" material="grid"/>
        
        <!-- Rocket body (main structure) -->
        <body name="rocket_body" pos="0 0 0">
            <inertial pos="0 0 -0.25" mass="5.0" diaginertia="0.2 0.2 0.05"/>
            
            <!-- Main rocket cylinder -->
            <geom name="rocket_main" type="cylinder" size="0.1 0.5" pos="0 0 -0.25" material="rocket"/>
            
            <!-- Rocket nose cone -->
            <geom name="rocket_nose" type="sphere" size="0.08" pos="0 0 0.3" material="rocket"/>
            
            <!-- Engine mount (bottom of rocket) -->
            <geom name="engine_mount" type="cylinder" size="0.12 0.05" pos="0 0 -0.52" material="rocket"/>
            
            <!-- Gimbal assembly -->
            <body name="gimbal_base" pos="0 0 -0.57">
                <inertial pos="0 0 0" mass="0.5" diaginertia="0.01 0.01 0.01"/>
                
                <!-- Gimbal base ring -->
                <geom name="gimbal_ring" type="cylinder" size="0.08 0.02" material="gimbal"/>
                
                <!-- Gimbal mechanism - pitch joint -->
                <joint name="gimbal_pitch" type="hinge" axis="1 0 0" range="-0.15 0.15" pos="0 0 0"/>
                
                <!-- Inner gimbal for yaw -->
                <body name="gimbal_inner" pos="0 0 -0.03">
                    <inertial pos="0 0 -0.1" mass="2.0" diaginertia="0.05 0.05 0.02"/>
                    
                    <!-- Yaw joint -->
                    <joint name="gimbal_yaw" type="hinge" axis="0 1 0" range="-0.15 0.15" pos="0 0 0"/>
                    
                    <!-- Inner gimbal ring -->
                    <geom name="gimbal_inner_ring" type="cylinder" size="0.06 0.015" material="gimbal"/>
                    
                    <!-- Engine/nozzle assembly -->
                    <body name="engine" pos="0 0 -0.1">
                        <inertial pos="0 0 -0.05" mass="2.0" diaginertia="0.02 0.02 0.01"/>
                        
                        <!-- Engine body -->
                        <geom name="engine_body" type="cylinder" size="0.05 0.08" material="thrust_nozzle"/>
                        
                        <!-- Thrust nozzle -->
                        <geom name="nozzle" type="cylinder" size="0.03 0.03" pos="0 0 -0.1" material="thrust_nozzle"/>
                        
                        <!-- Thrust vector visualization (invisible force application point) -->
                        <site name="thrust_point" pos="0 0 -0.13" size="0.01" rgba="1 0 0 0.5"/>
                    </body>
                </body>
                
                <!-- Actuator mounting points on gimbal base -->
                <site name="actuator_mount_0" pos="0.08 0 0" size="0.005" rgba="0 1 0 1"/>
                <site name="actuator_mount_1" pos="-0.04 0.0693 0" size="0.005" rgba="0 1 0 1"/>
                <site name="actuator_mount_2" pos="-0.04 -0.0693 0" size="0.005" rgba="0 1 0 1"/>
            </body>
            
            <!-- Actuator 1 (0 degrees) -->
            <body name="actuator_base_0" pos="0.08 0 -0.47">
                <inertial pos="0 0 0" mass="0.1" diaginertia="0.001 0.001 0.001"/>
                <geom name="actuator_base_0_geom" type="cylinder" size="0.01 0.02" material="actuator"/>
                
                <body name="actuator_rod_0" pos="0 0 0.05">
                    <inertial pos="0 0 0.03" mass="0.2" diaginertia="0.002 0.002 0.0001"/>
                    <joint name="actuator_0" type="slide" axis="0 0 1" range="0.08 0.12" pos="0 0 0"/>
                    <geom name="actuator_rod_0_geom" type="cylinder" size="0.008 0.03" material="actuator"/>
                </body>
            </body>
            
            <!-- Actuator 2 (120 degrees) -->
            <body name="actuator_base_1" pos="-0.04 0.0693 -0.47">
                <inertial pos="0 0 0" mass="0.1" diaginertia="0.001 0.001 0.001"/>
                <geom name="actuator_base_1_geom" type="cylinder" size="0.01 0.02" material="actuator"/>
                
                <body name="actuator_rod_1" pos="0 0 0.05">
                    <inertial pos="0 0 0.03" mass="0.2" diaginertia="0.002 0.002 0.0001"/>
                    <joint name="actuator_1" type="slide" axis="0 0 1" range="0.08 0.12" pos="0 0 0"/>
                    <geom name="actuator_rod_1_geom" type="cylinder" size="0.008 0.03" material="actuator"/>
                </body>
            </body>
            
            <!-- Actuator 3 (240 degrees) -->
            <body name="actuator_base_2" pos="-0.04 -0.0693 -0.47">
                <inertial pos="0 0 0" mass="0.1" diaginertia="0.001 0.001 0.001"/>
                <geom name="actuator_base_2_geom" type="cylinder" size="0.01 0.02" material="actuator"/>
                
                <body name="actuator_rod_2" pos="0 0 0.05">
                    <inertial pos="0 0 0.03" mass="0.2" diaginertia="0.002 0.002 0.0001"/>
                    <joint name="actuator_2" type="slide" axis="0 0 1" range="0.08 0.12" pos="0 0 0"/>
                    <geom name="actuator_rod_2_geom" type="cylinder" size="0.008 0.03" material="actuator"/>
                </body>
            </body>
        </body>
        
        <!-- External thrust source (for testing) -->
        <body name="thrust_source" pos="0 0 -1" mocap="true">
            <geom name="thrust_viz" type="sphere" size="0.02" rgba="1 0 0 0.5"/>
        </body>
    </worldbody>
    

    
    <!-- Actuators (motors) -->
    <actuator>
        <!-- Linear actuators -->
        <position name="actuator_ctrl_0" joint="actuator_0" ctrlrange="0.08 0.12" forcerange="-100 100" kp="1000"/>
        <position name="actuator_ctrl_1" joint="actuator_1" ctrlrange="0.08 0.12" forcerange="-100 100" kp="1000"/>
        <position name="actuator_ctrl_2" joint="actuator_2" ctrlrange="0.08 0.12" forcerange="-100 100" kp="1000"/>
    </actuator>
    
    <!-- Sensors -->
    <sensor>
        <!-- Joint positions -->
        <jointpos name="gimbal_pitch_pos" joint="gimbal_pitch"/>
        <jointpos name="gimbal_yaw_pos" joint="gimbal_yaw"/>
        
        <!-- Joint velocities -->
        <jointvel name="gimbal_pitch_vel" joint="gimbal_pitch"/>
        <jointvel name="gimbal_yaw_vel" joint="gimbal_yaw"/>
        
        <!-- Actuator positions -->
        <jointpos name="actuator_0_pos" joint="actuator_0"/>
        <jointpos name="actuator_1_pos" joint="actuator_1"/>
        <jointpos name="actuator_2_pos" joint="actuator_2"/>
        
        <!-- Body orientation (rocket attitude) -->
        <framequat name="rocket_orientation" objtype="body" objname="rocket_body"/>
        
        <!-- Body position and velocity -->
        <framepos name="rocket_position" objtype="body" objname="rocket_body"/>
        <framelinvel name="rocket_velocity" objtype="body" objname="rocket_body"/>
        <frameangvel name="rocket_angular_velocity" objtype="body" objname="rocket_body"/>
        
        <!-- Thrust point for force application -->
        <framepos name="thrust_point_pos" objtype="site" objname="thrust_point"/>
        <framequat name="thrust_point_orientation" objtype="site" objname="thrust_point"/>
    </sensor>
</mujoco> 